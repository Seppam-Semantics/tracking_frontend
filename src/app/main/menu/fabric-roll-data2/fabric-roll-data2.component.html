<!-- <mat-toolbar style="display: flex; justify-content: space-around;">
  <button  (click)="workorder()" class="btn btn-primary">Work Order</button>
  <button  (click)="yarn()" class="btn btn-primary">Yarn-Entry</button>
  <button  (click)="knite()" class="btn btn-primary">Knit-Entry</button>
  <button  (click)="Dye()" class="btn btn-primary">Dye-Entry</button>
</mat-toolbar> -->


<div style="display: flex; justify-content: center; gap: 15px;">

  <mat-form-field appearance="outline" (click)="clearAll()">
    <mat-label>Buyer</mat-label>
    <mat-select [(ngModel)]="buyerName" (selectionChange)="woByBuyer()">
      <mat-option value=""> </mat-option>
      <mat-option *ngFor="let buyer of this.buyers" value="{{buyer.buyer}}">{{buyer.buyer}}</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Order</mat-label>
    <mat-select [(ngModel)]="ordernumbers" (selectionChange)="wobyOrder()">
      <mat-option value=""> </mat-option>
      <mat-option *ngFor="let order of this.order" value="{{order.orderNO}}">{{order.orderNO}}</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Style</mat-label>
    <mat-select [(ngModel)]="styleslist" (selectionChange)="wobystyle()">
      <mat-option value=""> </mat-option>
      <mat-option *ngFor="let style of this.stylelist" value="{{style.style}}">{{style.style}}</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Color</mat-label>
    <mat-select [(ngModel)]="colorslist" (selectionChange)="wobycolor()">
      <mat-option value=""> </mat-option>
      <mat-option *ngFor="let color of this.colorlist" value="{{color.color}}">{{color.color}}</mat-option>
    </mat-select>
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Size</mat-label>
    <mat-select [(ngModel)]="sizeslist" (selectionChange)="wobysize()">
      <mat-option value=""> </mat-option>
      <mat-option *ngFor="let size of this.sizelist" value="{{size.size}}">{{size.size}}</mat-option>
    </mat-select>
  </mat-form-field>
  <div style="display: flex; justify-content: flex-end; gap: 10px;">
    <button mat-button color='primary' style="margin-right: 12px; margin-top: 2%;"
      (click)="exportexcel2()"><mat-icon>download</mat-icon>
      Download</button>
    <button mat-button color='primary' style="margin-right: 12px; margin-top: 2%;" (click)="fabricEntry()">New</button>

    <button mat-button color='primary' style="margin-right: 12px; margin-top: 2%;" (click)="FBReport()">Report</button>

  </div>
</div>

<!---===========================================================================================================-->

<div class="table-wrapper">
  <table id="table-data2" class="fl-table">
    <thead class="thead-dark">
      <tr>
        <th>S.No</th>
        <th>Buyer</th>
        <th>OrderNo</th>
        <th>Yarn Kg</th>
        <th>Greige Kg</th>
        <th>Finished Kg</th>
        <th>Order Pcs</th>
        <th>Order Value</th>
        <th>status</th>
        <th>Entry</th>
        <th>Edit</th>
        <th>Delet</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let work of this.data; let i=index" (click)="check(work.id)">

        <td>{{i+1}}</td>
        <td>{{work.buyer}}</td>
        <td>{{work.orderNo}}</td>
        <td>{{work.yarnKg}}</td>
        <td>{{work.greigeKg}}</td>
        <td>{{work.finishKg}}</td>
        <td>{{work.orderPcs}}</td>
        <td>{{work.ordervalue}}</td>

        <td>{{work.status === 1 ? 'Open' : 'Close'}}</td>


        <td><button class="btn btn-success" (click)=" visibleEntry = true"><mat-icon>insert_drive_file</mat-icon>
          </button></td>

        <td><button class="btn btn-primary" data-toggle="modal" data-target="#edit"
            (click)="edit(work.id)"><mat-icon>edit</mat-icon></button></td>
        <td><button class="btn btn-danger" (click)="delete(work.id)"><mat-icon>delete</mat-icon></button></td>
      </tr>

    <tbody>
  </table>
</div>

<!---===========================================================================================================-->

<ngx-spinner *ngIf="LoadingTotal">Loading...!</ngx-spinner>

<!---===========================================================================================================-->

<p-dialog [resizable]="true" [modal]="true" [maximizable]="true" [(visible)]="visibleEntry" [style]="{width: '90vw'}"
  [contentStyle]="{height: '90vh'}" header="Fabric Entry">
  <fieldset>
    <legend>Buyer :  SOLO | OrderNo :  1012267  </legend>
    <div class="tableoverall">
      <table class="table table-striped">
        <thead class="thead-dark">
          <tr>
            <th>Style</th>
            <th>Color</th>
            <th>GSize</th>

            <th>FSize</th>
            <th>FabDia</th>
            <th>FabGsm</th>

            <th>KnitSL</th>
            <th>Yarn Type</th>
            <th>FabType</th>

            <th>Dye Type</th>
            <th>SpinFty</th>
            <th>KnitFty</th>

            <th>DyeinFty</th>
            <th>OrderPcs</th>
            <th>OrderFOBRate</th>

            <th>KnitRate</th>
            <th>DyeRate</th>
            <th>YarnKg</th>

            <th>GreigeKg</th>
            <th>FinishKg</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td></td>
            <td></td>
            <td></td>

            <td></td>
            <td></td>
            <td></td>

            <td></td>
            <td></td>
            <td></td>

            <td></td>
            <td></td>
            <td></td>

            <td></td>
            <td></td>
            <td></td>

            <td></td>
            <td></td>
            <td></td>

            <td></td>
            <td></td>

          </tr>
        </tbody>
      </table>
    </div>
  </fieldset>

  <ng-template pTemplate="footer">
    <button mat-button color="primary" (click)="exportexcel()" style="display: flex; justify-content: lefts;">
      <mat-icon>download</mat-icon> Download File</button>
  </ng-template>
</p-dialog>

<!---===========================================================================================================-->

<p-dialog [resizable]="true" [modal]="true" [maximizable]="true" [(visible)]="visible" [style]="{width: '90vw'}"
  [contentStyle]="{height: '90vh'}" [formGroup]="buyerorderform" header="Fabric Booking">
  <fieldset>
    <legend><div style="display: flex;"> <div><p>Buyer</p> : <p> SOLO </p> </div> <div> <p>OrderNo</p> : <p> 1012267 </p> </div>  </div></legend>
    <div class="tableoverall">
    <table class="table table-striped">
      <thead class="thead-dark">
        <tr>  
          <th><Button class="btn btn-primary" (click)="add1button()">+</Button></th>
          <th>Style</th>
          <th>Color</th>
          <th>GSize</th>
  
          <th>FSize</th>
          <th>FabDia</th>
          <th>FabGsm</th>
          <th>KnitSL</th>
  
          <th>Yarn Type</th>
          <th>FabType</th>
          <th>Dye Type</th>
  
          <th>SpinFty</th>
          <th>KnitFty</th>
          <th>DyeinFty</th>
  
          <th>OrderPcs</th>
          <th>OrderFOBRate</th>
          <th>KnitRate</th>
          <th>DyeRate</th>
  
          <th>YarnKg</th>
          <th>GreigeKg</th>
          <th>FinishKg</th>
  
          <th>Remove</th>
        </tr>
      </thead>
      <tbody formArrayName="data">
        <tr *ngFor="let process of items.controls; let i=index" [formGroupName]="i">
          <td></td>
          
          <td><input style="width: 15vh;" formControlName="Style" class="form-control"></td>
  
  
          <td><input style="width: 15vh;" formControlName="Color" class="form-control"></td>
  
          <td><input style="width: 15vh;" formControlName="Size" class="form-control"></td>
  
          <td><input style="width: 15vh;" formControlName="fSize" class="form-control"></td>
  
          <td><input style="width: 15vh;" formControlName="FabDia" class="form-control"></td>
  
          <td><input style="width: 15vh;" formControlName="FabGsm" class="form-control"></td>
  
          <td><input style="width: 15vh;" formControlName="KnitSL" type="number" class="form-control"></td>
  
          <td><input style="width: 15vh;" formControlName="YarnType" class="form-control"></td>
  
          <td><input style="width: 15vh;" formControlName="FabType" class="form-control"></td>
  
          <td><input style="width: 15vh;" formControlName="dyetype" class="form-control"></td>
  
  
          <td><input style="width: 15vh;" formControlName="SpinFty" class="form-control"></td>
  
          <td><input style="width: 15vh;" formControlName="KnitFty" class="form-control"></td>
  
          <td><input style="width: 15vh;" formControlName="DyeinFty" class="form-control"></td>
  
          <td><input style="width: 15vh;" formControlName="OrderPcs" class="form-control"></td>
  
          <td><input style="width: 15vh;" formControlName="OrderFOBRate" class="form-control"></td>
  
          <td><input style="width: 15vh;" formControlName="KnitRate" class="form-control"></td>
  
          <td><input style="width: 15vh;" formControlName="DyeRate" class="form-control"></td>
  
          <td><input style="width: 15vh;" formControlName="YarnKg" class="form-control"></td>
  
          <td><input style="width: 15vh;" formControlName="GreigeKg" class="form-control"></td>
  
          <td><input style="width: 15vh;" formControlName="FinishKg" class="form-control"></td>
  
          <td><button (click)="Delete(i)" style="background-color: red; color: white;">x</button></td>
  
  
  
        </tr>
      </tbody>
    </table>
</div>
  </fieldset>

  <ng-template pTemplate="footer">
    <div style="display: flex; width: 100%; justify-content: center;">
      <!-- <button (click)="woupdatesubmit()" mat-button color="primary"><mat-icon>save</mat-icon>Save</button> -->
    </div>
  </ng-template>
</p-dialog>