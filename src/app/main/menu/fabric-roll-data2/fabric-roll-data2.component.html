<mat-toolbar style="display: flex; justify-content: center; height: 7vh;">

  <div style="flex: 1 1 auto;"></div>
  <div style="display: flex; gap: 10px;">
      <div style="display: flex; gap: 10px;">

          <input class="form-control me-2" type="search" placeholder="Buyer Search" aria-label="Search"
          [(ngModel)]="buyerName" (change)="woByBuyer()" list="BuyerSearch">
  
        <datalist id="BuyerSearch">
          <option *ngFor="let data of buyers;" [value]="data.buyer">{{data.buyer}}</option>
        </datalist>


        <input class="form-control me-2" type="search" placeholder="Order Search" aria-label="Search"
        [(ngModel)]="ordernumbers" (change)="wobyOrder()" list="Order" >

      <datalist id="Order">
        <option *ngFor="let data of this.order;" [value]="data.orderNO">{{data.orderNO}}</option>
      </datalist>

      </div>

  </div>

  <button mat-button color='primary' 
  (click)="exportexcel2()"><mat-icon>download</mat-icon>
  Download</button>
<button mat-button color='primary' (click)="fabricEntry()">New</button>

<button mat-button color='primary' (click)="FBReport()">Report</button>
</mat-toolbar>

<!---===========================================================================================================-->

<div class="table-wrapper">
  <table id="table-data2" class="fl-table">
    <thead class="thead-dark">
      <tr>
        <th>S.No</th>
        <th>Buyer</th>
        <th>OrderNo</th>
        <th>Yarn Kg</th>
        <th>Greige Kg</th>
        <th>Finished Kg</th>
        <th>Order Pcs</th>
        <th>Order Value</th>
        <th>status</th>
        <th>Entry</th>
        <th>Edit</th>
        <th>Delete</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let work of this.data; let i=index">

        <td>{{i+1}}</td>
        <td>{{work.buyer}}</td>
        <td>{{work.orderNo}}</td>
        <td>{{work.yarnKg}}</td>
        <td>{{work.greigeKg}}</td>
        <td>{{work.finishKg}}</td>
        <td>{{work.orderPcs}}</td>
        <td>{{work.ordervalue}}</td>

        <td>{{work.status === 1 ? 'Open' : 'Close'}}</td>


        <td><button class="btn btn-success" (click)="woLineDetails(work.orderNo)" ><mat-icon>insert_drive_file</mat-icon>
          </button></td>

        <td><button class="btn btn-primary" (click)="edit(work.orderNo)"><mat-icon>edit</mat-icon></button></td>
        <td><button class="btn btn-danger" (click)="delete(work.id)"><mat-icon>delete</mat-icon></button></td>
      </tr>

    <tbody>
  </table>
</div>

<!---===========================================================================================================-->

<ngx-spinner *ngIf="LoadingTotal">Loading...!</ngx-spinner>

<!---===========================================================================================================-->

<p-dialog [resizable]="true" [modal]="true" [maximizable]="true" [(visible)]="visibleEntry" [style]="{width: '90vw'}"
  [contentStyle]="{height: '90vh'}" header="Fabric Entry">
  <fieldset>
    <legend>Buyer :  {{this.woBuyervalue}} / OrderNo :  {{this.woorderNovalue}}  </legend>
    <div class="tableoverall">
      <table class="table table-striped">
        <thead class="thead-dark">
          <tr>
            <th>Style</th>
            <th>Color</th>
            <th>GSize</th>

            <th>FSize</th>
            <th>FabDia</th>
            <th>FabGsm</th>

            <th>KnitSL</th>
            <th>Yarn Type</th>
            <th>FabType</th>

            <th>Dye Type</th>
            <th>SpinFty</th>
            <th>KnitFty</th>

            <th>DyeinFty</th>
            <th>OrderPcs</th>
            <th>OrderFOBRate</th>

            <th>KnitRate</th>
            <th>DyeRate</th>
            <th>YarnKg</th>

            <th>GreigeKg</th>
            <th>FinishKg</th>

            <th>Fabric Report</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let data of this.data2; let i = index;" style="width: auto;">
            <td>{{data.style}}</td>
            <td>{{data.color}}</td>
            <td>{{data.size}}</td>

            <td>{{data.FSize}}</td>
            <td>{{data.fabDia}}</td>
            <td>{{data.fabGsm}}</td>

            <td>{{data.knitSL}}</td>
            <td>{{data.yarnType}}</td>
            <td>{{data.fabType}}</td>

            <td>{{data.dyetype}}</td>
            <td>{{data.spinFty}}</td>
            <td>{{data.knitFty}}</td>

            <td>{{data.dyeinFty}}</td>
            <td>{{data.orderPcs}}</td>
            <td>{{data.orderFOBRate}}</td>

            <td>{{data.knitRate}}</td>
            <td>{{data.dyeRate}}</td>
            <td>{{data.yarnKg}}</td>

            <td>{{data.greigeKg}}</td>
            <td>{{data.finishKg}}</td>

            <td><button class="btn btn-success" (click)="fabricreport(data)"><mat-icon>insert_drive_file</mat-icon></button></td>

          </tr>
        </tbody>
      </table>
    </div>
  </fieldset>

  <ng-template pTemplate="footer">
    <button mat-button color="primary" (click)="exportexcel()" style="display: flex; justify-content: lefts;">
      <mat-icon>download</mat-icon> Download File</button>
  </ng-template>
</p-dialog>

<!---===========================================================================================================-->

<p-dialog [resizable]="true" [modal]="true" [maximizable]="true" [(visible)]="visible" [style]="{width: '90vw'}"
  [contentStyle]="{height: '90vh'}" [formGroup]="buyerorderform" header="Fabric Booking">
  <fieldset>
    <legend>Buyer :  {{this.woBuyervalue2}}  /  OrderNo :  {{this.woorderNovalue2}} </legend>
    <div class="tableoverall">
    <table class="table table-striped">
      <thead class="thead-dark">
        <tr>  
          <!-- <th><Button class="btn btn-primary" (click)="add1button()">+</Button></th> -->
          <th>Style</th>
          <th>Color</th>
          <th>GSize</th>
  
          <th>FSize</th>
          <th>FabDia</th>
          <th>FabGsm</th>
          <th>KnitSL</th>
  
          <th>Yarn Type</th>
          <th>FabType</th>
          <th>Dye Type</th>
  
          <th>SpinFty</th>
          <th>KnitFty</th>
          <th>DyeinFty</th>
  
          <th>OrderPcs</th>
          <th>OrderFOBRate</th>
          <th>KnitRate</th>
          <th>DyeRate</th>
  
          <th>YarnKg</th>
          <th>GreigeKg</th>
          <th>FinishKg</th>
  
          <th>Status</th>
          <th>Remove</th>
        </tr>
      </thead>
      <tbody formArrayName="data">
        <tr *ngFor="let process of items.controls; let i=index" [formGroupName]="i">
          
          <td><input style="width: 15vh;" formControlName="Style" class="form-control" readonly ></td>
  
  
          <td><input style="width: 15vh;" formControlName="Color" class="form-control" readonly ></td>
  
          <td><input style="width: 15vh;" formControlName="Size" class="form-control" readonly ></td>
  
          <td><input style="width: 15vh;" formControlName="fSize" class="form-control" readonly ></td>
  
          <td><input style="width: 15vh;" formControlName="FabDia" class="form-control" readonly ></td>
  
          <td><input style="width: 15vh;" formControlName="FabGsm" class="form-control" readonly></td>
  
          <td><input style="width: 15vh;" formControlName="KnitSL" type="number" class="form-control" ></td>
  
          <td><input style="width: 15vh;" formControlName="YarnType" class="form-control" readonly></td>
  
          <td><input style="width: 15vh;" formControlName="FabType" class="form-control" readonly></td>
  
          <td><input style="width: 15vh;" formControlName="dyetype" class="form-control" readonly></td>
  
  
          <td><input style="width: 15vh;" formControlName="SpinFty" class="form-control" readonly></td>
  
          <td><input style="width: 15vh;" formControlName="KnitFty" class="form-control" readonly></td>
  
          <td><input style="width: 15vh;" formControlName="DyeinFty" class="form-control" readonly></td>
  
          <td><input style="width: 15vh;" formControlName="OrderPcs" class="form-control" ></td>
  
          <td><input style="width: 15vh;" formControlName="OrderFOBRate" class="form-control" ></td>
  
          <td><input style="width: 15vh;" formControlName="KnitRate" class="form-control" ></td>
  
          <td><input style="width: 15vh;" formControlName="DyeRate" class="form-control" ></td>
  
          <td><input style="width: 15vh;" formControlName="YarnKg" class="form-control" readonly></td>
  
          <td><input style="width: 15vh;" formControlName="GreigeKg" class="form-control" readonly></td>
  
          <td><input style="width: 15vh;" formControlName="FinishKg" class="form-control" readonly></td>
  
          <td> <p-dropdown [options]="[{ 'name': 'True', 'id':1 }, { 'name': 'False', 'id': 0 }]"
            placeholder="Select a Status" formControlName="status"  optionLabel="name"
            optionValue="id"></p-dropdown>
          </td>

          <td><button (click)="Delete(i)" style="background-color: red; color: white;">x</button></td>
  
  
  
        </tr>
      </tbody>
    </table>
</div>
  </fieldset>

  <ng-template pTemplate="footer">
    <div style="display: flex; width: 100%; justify-content: center;">
      <button (click)="woupdatesubmit()" mat-button color="primary"><mat-icon>save</mat-icon>Update</button>
    </div>
  </ng-template>
</p-dialog>