<div>
  <div>
    <mat-toolbar style="display: flex; justify-content: center; height: auto;">
      <span>Yarn Report</span>
    </mat-toolbar>
  </div>
  <div style="display: flex; align-items: center; justify-content: space-between;">
    <div style="display: flex; align-items: center; justify-content: center; width: 70%; gap: 20px; margin-top: 1%;">
      <mat-form-field appearance="outline">
        <mat-label>Spin Fty</mat-label>
        <mat-select [(ngModel)]="spinfactory" (selectionChange)="yarnlcNo()">
          <mat-option></mat-option>
          <mat-option *ngFor="let spin of this.spinfty" value="{{spin.spinner}}">{{spin.spinner}}</mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Lc No.</mat-label>
        <mat-select [(ngModel)]="spinLcNo" (selectionChange)="yarnStatus()">
          <mat-option></mat-option>
          <mat-option *ngFor="let spin of this.spinDDLcNo" value="{{spin.lcNo}}">{{spin.lcNo}}</mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Status</mat-label>
        <mat-select [(ngModel)]="spinStatus" (selectionChange)="yarnDatawithStatus()">
          <mat-option></mat-option>
          <mat-option *ngFor="let spin of this.someStatus" value="{{spin.yarnStatus}}">{{spin.yarnStatus}}</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div style="flex: 1 1 auto;"></div>

    <div>
      <button mat-button color="primary" (click)="yarnHead()">New Header</button>
    </div>

    <div>
      <button mat-button color="primary" (click)="exportexcel()"><mat-icon>download</mat-icon>Download</button>
    </div>


    <button mat-button color="primary" [matMenuTriggerFor]="menu">
      Report
    </button>
    <mat-menu #menu="matMenu">
      <!-- <button mat-menu-item (click)="yarnHead()">
        <span>New Header</span>
      </button> -->
      <button mat-menu-item (click)="outstanding()">
        <span>LC Outstanding</span>
      </button>
      <button mat-menu-item (click)="reconciliation()">
        <span>Reconciliation</span>
      </button>
    </mat-menu>

  </div>
  <div class="YarnReportScrol" style="margin-top: 1%;">
    <table class="table table-hover" id="table-data">
      <thead class="thead-dark">
        <tr>
          <th>S.No</th>
          <th>Spin Fty</th>
          <th>LC Date</th>
          <th>LC no</th>
          <th>PI</th>
          <th>PI Date</th>
          <th>LC Yarn Kgs</th>
          <th>LC Value</th>
          <th>Status</th>
          <th>Edit</th>
          <th>Delete</th>
          <th>Report</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let data of this.AllData;let i = index">
          <td>{{i+1}}</td>
          <td >{{data.spinner}}</td>
          <td >{{data.lcDate}}</td>
          <td >{{data.lcNo}}</td>
          <td >{{data.pi}}</td>
          <td >{{data.piDate}}</td>
          <td >{{data.lcYarnTotal}}</td>
          <td >{{data.lcValue}}</td>
          <td >{{data.yarnStatus}}</td>
          <td><button class="btn btn-primary" (click)="EditAllData(data.id)"><mat-icon>edit</mat-icon></button></td>
          <td><button class="btn btn-danger" (click)="delete(data.id)"><mat-icon>delete</mat-icon></button></td>
          <td><button class="btn btn-success" (click)="view(data.id)"><mat-icon>insert_drive_file</mat-icon></button></td>
        </tr>

      </tbody>
    </table>
  </div>
</div>



<p-dialog [(visible)]="ViewAllYarnData" [modal]="true" [style]="{ width: '100%', height : '100%' }"
  header="LC Closure Report" [maximizable]="true" [resizable]="true">


  <div>
    <table class="table table-hover table-bordered" id="table-data1">
      <tbody>
        <tr *ngFor="let YarnData of this.yarndetails ; let i = index;">
          <td><b>LC no :</b> {{YarnData.lcNo}} </td>
          <td><b>PI :</b> {{YarnData.pi}} </td>
          <td><b>LC Qty :</b> {{YarnData.lcYarnTotal}} </td>
          <td><b>LC Date :</b> {{YarnData.lcDate}} </td>
          <td><b>PI date :</b> {{YarnData.piDate}} </td>
          <td><b>LC Value :</b> {{YarnData.lcValue}} </td>
        </tr>
      </tbody>
    </table>
  </div>


  <div *ngFor="let data of this.yarn_lc_lines_Details; let i = index;">
    <p-panel header="LineEntey {{i+1}}">
      <div>
        <table class="table table-hover table-bordered" style="margin-top: -15px;" id="table-data2">
          <tbody>
            <tr>
              <td>Yarn Type : {{data.yarnType}} </td>
              <td>Yarn Kgs : {{data.yarnValue}} </td>
              <td>Yarn Rate : {{data.yarnRate}} </td>
              <td>LC Value : {{data.lcYarnKgs}} </td>
            </tr>
          </tbody>
        </table>
      </div>
      <p-panel header="Lot Check">
        <div>
          <table class="table table-hover table-bordered" style="margin-top: -15px;" id="table-data3">
            <thead class="thead-dark">
              <tr>
                <th>Lot No</th>
                <th>Sample Dt</th>
                <th>Result Dt</th>
                <th>Remarks</th>
                <th>Acc/Rej</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let lotcheckData of parseLotcheck(data); let j = index">
                <td>{{lotcheckData.lotNo}}</td>
                <td>{{lotcheckData.sampleDate}}</td>
                <td>{{lotcheckData.resultDate}}</td>
                <td>{{lotcheckData.checkResults}}</td>
                <td>{{lotcheckData.acceptRejectStatus}}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </p-panel>

        <div *ngFor="let OrderAllData of parseOrderall(data); let k = index" style="margin-top: -16px;">

          <table class="table table-hover table-bordered" id="table-data4">
            <tbody>
            <tr>
              <td><b>Buyer :</b> {{OrderAllData.buyer}}</td>
              <td><b>OrderNo :</b> {{OrderAllData.utilisationOrderNo}}</td>
              <td><b>Style :</b> {{OrderAllData.style}}</td>
              <td><b>Color :</b> {{OrderAllData.colour}}</td>
              <td><b>Allocated :</b> {{OrderAllData.allocatedYarnKgs}}</td>
            </tr>
          </tbody>
          </table>

          <table class="table table-hover table-bordered" id="table-data5">
            <thead class="thead-dark">
              <tr>
                <th style="width: 40vh;">Receipt Dt</th>
                <th style="width: 40vh;">Receipt Qty</th>

              </tr>
            </thead>
            <tbody *ngFor="let receipt of parseRec(OrderAllData); let i = index">
              <tr>
                <td>{{receipt.receiptDt === 'null' ? '' : receipt.receiptDt}}</td>
                <td>{{receipt.receiptYarnKgs === 'null' ? '' : receipt.receiptYarnKgs}}</td>
                <div *ngFor="let quality of receipt.quality">
                  <td> checkDate : {{quality.checkDate === 'null' ? '' : quality.checkDate}}</td>
                  <td> checkResults : {{quality.checkResults === 'null' ? '' : quality.checkResults}}</td>
                  <td> AcceptRejectStatus : {{quality.yarnAcceptRejectStatus === '1' ? 'Accept' : 'Reject'}}</td>
                </div>
              </tr>
            </tbody>
          </table>
        </div>
      </p-panel>
  </div>
  <ng-template pTemplate="footer">
    <button mat-button color="danger" (click)="ViewAllYarnData = false"><mat-icon>close</mat-icon>close</button>
    <button mat-button color="primary" (click)="exportToExcel2()"><mat-icon>download</mat-icon>Download</button>
  </ng-template>
</p-dialog>