<div>
    <div>
        <mat-toolbar style="display: flex; justify-content: center; height: auto;">
            <span>Yarn Report</span>
        </mat-toolbar>
    </div>
    <div>
        <table class="table">
            <thead class="thead-dark">
                <tr>
                    <th>Sl.No</th>
                    <th>Spin Fty</th>
                    <th>LC Date</th>
                    <th>LC no</th>

                    <th>PI</th>
                    <th>PI Date</th>
                    <th>LC Yarn Kgs</th>

                    <th>LC Value</th>
                    <th>Status</th>
                    <th>Edit</th>

                    <th>Delete</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let data of this.AllData;let i = index">
                <td>{{i+1}}</td>
                <td>{{data.spinner}}</td>
                <td>{{data.lcDate}}</td>
                <td>{{data.lcNo}}</td>

                <td>{{data.pi}}</td>
                <td>{{data.piDate}}</td>
                <td>{{data.lcYarnKgs}}</td>

                <td>{{data.lcValue}}</td>
                <td>{{data.yarnStatus}}</td>
                <td><button class="btn btn-primary" data-toggle="modal" data-target="#edit" (click)="EditAllData(data.id)"><mat-icon>edit</mat-icon></button></td>

                <td><button class="btn btn-primary"><mat-icon>delete</mat-icon></button></td>
            </tr>

            </tbody>
        </table>
    </div>
</div>

<!--------------------------------------------------------------------------------------------------->

<div class="modal fade" id="edit" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-fullscreen" role="document">
        <div class="modal-content">
            <div class="modal-body">
<!--------------------------------------------------------------------------------------------------->
<div [formGroup]="yarnHeader">
    <table class="table">
        <thead class="thead-dark">
            <tr>
                <th>Spin Fty</th>
                <th>LC Date</th>
                <th>LC no</th>
                <th>PI</th>
                <th>PI Date</th>
                <th>LC Yarn Kgs</th>
                <th>LC Value</th>
                <th>Status</th>
            </tr>
        </thead>

        <tbody>
            <tr>
                <td>
                    <input type="text" class="form-control" formControlName="spinner" readonly>
                </td>
                <td><input type="date" class="form-control" formControlName="lcDate" readonly></td>
                <td><input type="text" class="form-control" formControlName="lcNo" readonly></td>
                <td><input type="text" class="form-control" formControlName="pi" readonly></td>
                <td><input type="date" class="form-control" formControlName="piDate" readonly></td>
                <td><input type="text" class="form-control" readonly formControlName="lcYarnKgs"></td>
                <td><input type="text" class="form-control" readonly formControlName="lcValue"></td>
                <td><select class="form-control" formControlName="yarnStatus">
                        <option value="open">open</option>
                        <option value="close">close</option>
                    </select></td>
            </tr>
        </tbody>
    </table>
</div>
<mat-tab-group>
    <!-------------------------------Header[Start]----------------------------------->
    <mat-tab label="Header" [formGroup]="Yarn_Entry_1">
        <div style="overflow: scroll; height: 65vh; margin-top: 1%;">
            <div>
                <table class="table">
                    <thead class="thead-dark">
                        <tr>
                            <th>
                                <button class="btn btn-danger" (click)="add1button()" style="font-size:inherit">Add lines</button>
                            </th>
                            <th>Yarn Type</th>
                            <th>LC Yarn Kgs</th>
                            <th>Yarn Rate</th>
                            <th>LC Value</th>
                            <th>Lot Check</th>
                            <th>Order Allocation</th>
                            <th></th>
                        </tr>
                    </thead>

                    <tbody formArrayName="data">

                        <tr *ngFor="let process of items.controls; let i=index" [formGroupName]="i">
                            <td></td>
                            <td><input type="text" class="form-control" formControlName="yarnType" type="text"></td>
                            <td><input type="text" class="form-control" formControlName="lcYarnKgs" type="number"></td>
                            <td><input type="text" class="form-control" formControlName="yarnRate" type="number"></td>
                            <td><input type="number" class="form-control" formControlName="yarnValue"></td>
                            <td><button class="btn btn-primary" data-toggle="modal" data-target="#lotCheckModal" (click)="lotcheckaddUpdate(i)">Lot Check</button></td>
                            <td><button class="btn btn-primary" data-toggle="modal" data-target="#orderAllocationModal" (click)="orderAllotAddUpdate(i)">Order Allocation</button></td>
                            <td><button class="btn-danger" (click)="Yarn_Entry_Delete(i)">x</button></td>
                        </tr>
                    </tbody>
                    <tr>
                        <td><b>Total</b></td>
                        <td></td>
                        <td><input type="number" class="form-control" readonly
                                [value]="Yarn_Entry_1.get('Total10')?.value"></td>
                        <td></td>
                        <td><input type="number" class="form-control" readonly
                                [value]="Yarn_Entry_1.get('Total12')?.value"></td>
                        <td></td>
                    </tr>
                </table>
                <div style="display: flex; justify-content: center; align-items: center; margin-top: 2%;">
                    <button class="btn btn-primary" (click)="Yarn_Entry_save()">Update</button>
                </div>
            </div>
        </div>
        <div class="modal fade" id="lotCheckModal" tabindex="-1" role="dialog" aria-labelledby="lotCheckModalLabel"
            aria-hidden="true">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-body">
                        <div style="overflow: scroll; height: 75vh;">
                            <div [formGroup]="LotCheck">
                                <table class="table" style="width: auto;">
                                    <thead class="thead-dark">
                                        <tr>
                                            <th>Yarn Type</th>
                                            <th>Lot no</th>
                                            <th>Sample Dt</th>
                                            <th>Result Dt</th>
                                            <th>Results</th>
                                            <th>Accept / Reject</th>
                                            <th></th>
                                        </tr>
                                    </thead>
        
                                    <tbody formArrayName="data">
                                        <tr *ngFor="let process of LotCheckItems.controls; let i = index;" [formGroupName]="i">
                                            <td>
                                                <input formControlName="yarnType" class="form-control" style="width: 100px;">
                                            </td>
                                            <td><input formControlName="lotNo" class="form-control" style="width: 100px;"></td>
        
                                            <td>
                                                <input type="date" class="form-control" formControlName="sampleDate">
                                            </td>
                                            <td>
                                                <input type="date" class="form-control" formControlName="resultDate">
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" formControlName="checkResults">
                                            </td>
        
                                            <td>
                                                <mat-checkbox formControlName="acceptRejectStatus"></mat-checkbox>
                                            </td>
                                            <td><button class="btn btn-danger" (click)="lotCheckDelete(i)">Delete</button></td>
                                        </tr>
                                    </tbody>
                                </table>
                                <button class="btn btn-danger" style="font-size: inherit;" (click)="LotCheckAddButton()">Add
                                    Lines</button>
                            </div>
                            <div style="display: flex; justify-content: center;"> <button class="btn btn-primary"
                                    (click)="LotCheck_Button()">Update</button></div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <div style="display: flex; justify-content: center;">
                            <button class="btn btn-danger" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="orderAllocationModal" tabindex="-1" role="dialog" aria-labelledby="orderAllocationModalLabel"
            aria-hidden="true">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-body">
                        <div style="overflow: scroll; height: 75vh;" [formGroup]="OrderAllocation">
                            <div style="display: flex; justify-content: center; align-items: center;">
                                    <select formControlName="buyer" (change)="getorders($event.target.value)" class="form-select" style="width: 200px;">
                                      <option value="">--Buyers-- </option>
                                      <option *ngFor="let buyer of this.buyers" value="{{buyer.buyer}}">{{buyer.buyer}}</option>
                                    </select>
                            </div>
                            <div style="margin-top: 2%;">
                                <table class="table">
                                    <thead class="thead-dark">
                                        <tr>
                                            <th><button class="btn btn-danger" (click)="OrderAllocationAddButton()"
                                                    style="font-size: inherit;">+</button></th>
                                            <th>Yarn Type</th>
                
                                            <th>Order No</th>
                                            <th>Style</th>
                                            <th>Colour</th>
                                            <th>Lot No</th>
                
                                            <th>Allocated Yarn Kgs</th>
                                            <th>Unallocated Yarn Kgs</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                
                                    <tbody formArrayName="data">
                                        <tr *ngFor="let process of items2.controls; let i=index" [formGroupName]="i">
                                            <td></td>
                                            <td>
                                                <input type="text" class="form-control" formControlName="yarnType" list="yarnType">
                                                <datalist id="yarnType">
                                                    <option *ngFor="let order of this.yarnTypeOrder" value="{{order.yarnType}}"></option>
                                                </datalist>
                                            </td>
                
                                            <td>
                                                <input type="text" class="form-control" formControlName="utilisationOrderNo" list="order" (input)="getstyle($event.target.value)">
                                                <datalist id="order">
                                                    <option *ngFor="let order of this.orderNo" value="{{order.orderNO}}"></option>
                                                </datalist>
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" formControlName="style" list="styles">
                                                <datalist id="styles">
                                                    <option></option>
                                                    <option *ngFor="let style of this.style" value="{{style.style}}">{{style.style}}</option>
                                                </datalist>
                                            </td>
                                            <td><input type="text" class="form-control" formControlName="colour"></td>
                                            <td>
                                                <input type="text" class="form-control" formControlName="lotNo" list="spinLot">
                                                <datalist id="spinLot">
                                                    <option *ngFor="let lot of yarnTypeOrder" value="{{lot.lotNo}}"></option>
                                                </datalist>
                                            </td>
                
                                            <td><input type="number" class="form-control" formControlName="allocatedYarnKgs"></td>
                                            <td><input type="text" class="form-control" formControlName="unallocatedYarnKgs" readonly></td>
                                            <td><button class="btn btn-danger" (click)="OrderAllocationDelete(i)">Delete</button></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div style="display: flex; justify-content: center;">
                                <button class="btn btn-primary" (click)="OrderAllocationSave()">Update</button>
                            </div>
                        </div>                    <div class="modal-footer">
                        <div style="display: flex; justify-content: center;">
                            <button class="btn btn-danger" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        </div>
    </mat-tab>

<!-------------------------------Header[Ends]----------------------------------->

<!-- ============================================================================================================================================================================ -->
    
<!-------------------------------Lot Check[Start]----------------------------------->
    <mat-tab label="Lot Check" >
        <div style="overflow: scroll; height: 75vh; margin-top: 3%;">
            <div [formGroup]="LotCheck">
                <table class="table">
                    <thead class="thead-dark">
                        <tr>
                            <th>Sl.No</th>
                            <th>Yarn Type</th>
                            <th>Lot no</th>
                            <th>Sample Dt</th>
                            <th>Result Dt</th>
                            <th>Results</th>
                            <th>Accept / Reject</th>
                        </tr>
                    </thead>

                    <tbody>
                        <tr *ngFor="let lot of this.yarnLotCheck; let i = index;">
                            <td>{{i+1}}</td>
                            <td>{{lot.yarnType}}</td>
                            <td>{{lot.lotNo}}</td>
                            <td>{{lot.sampleDate}}</td>
                            <td>{{lot.resultDate}}</td>
                            <td>{{lot.checkResults}}</td>
                            <td>{{lot.acceptRejectStatus == 1 ? 'Accept': 'Reject'}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </mat-tab>
    <!-------------------------------Lot Check[Ends]----------------------------------->

    <!-------------------------------Order Allocation[Start]----------------------------------->
    <mat-tab label="Order Allocation">
        <div style="overflow: scroll; height: 75vh; margin-top: 3%;">
            <div>
                <table class="table">
                    <thead class="thead-dark">
                        <tr>
                            <th>Sl.No</th>
                            <th>Yarn Type</th>
                            <th>Order No</th>
                            <th>Style</th>
                            <th>Colour</th>
                            <th>Lot No</th>
                            <th>Allocated Yarn Kgs</th>
                            <th>Unallocated Yarn Kgs</th>
                            <th>Receipt</th>
                        </tr>
                    </thead>

                    <tbody>
                        <tr *ngFor="let order of this.yarnOrderAllocations; let i = index;">
                            <td>{{i+1}}</td>
                            <td>{{order.yarnType}}</td>
                            <td>{{order.utilisationOrderNo}}</td>
                            <td></td>
                            <td>{{order.colour}}</td>
                            <td>{{order.lotNo}}</td>
                            <td>{{order.allocatedYarnKgs}}</td>
                            <td>{{order.unallocatedYarnKgs}}</td>
                            <td><button class="btn btn-primary" data-toggle="modal" data-target="#receiptModal"  (click)="orderId(i)">Receipt</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="modal fade" id="receiptModal" tabindex="-1" role="dialog" aria-labelledby="receiptModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content">
                    <div class="modal-body">
                        <div style="overflow: scroll; height: 75vh;">
                            <div [formGroup]="receiptForm">
                                <table class="table">
                                    <thead class="thead-dark">
                                        <tr>
                                            <th>Spin Challan</th>
                                            <th>SBDL Challan</th>
                                            <th>Receipt Dt</th>
                                            <th>Knit Factory</th>
                                            <th>Bags/Ctn - nos</th>
                                            <th>Receipt Yarn Kgs</th>
                                            <th>Pending Receipts - Kgs</th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody formArrayName="data">
                                        <tr *ngFor="let process of items3.controls; let i=index" [formGroupName]="i">
                                            <td>
                                                <input type="text" class="form-control" formControlName="spinningChallan">
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" formControlName="scandexChallan">
                                            </td>
                                            <td>
                                                <input type="date" class="form-control" formControlName="receiptDt">
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" formControlName="knitFactory">
                                            </td>
                                            <td>
                                                <input type="number" class="form-control" formControlName="BagsCtnNos">
                                            </td>
                                            <td>
                                                <input type="number" class="form-control" formControlName="receiptYarnKgs">
                                            </td>
                                            <td>
                                                <input type="text" class="form-control" formControlName="pendingReceiptKgs">
                                            </td>
                                            <td>
                                                <button class="btn btn-danger" (click)="ReceiptDelete(i)">x</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                    <button class="btn btn-danger" (click)="ReceiptAddButton()" style="font-size: inherit;">AddLines</button>
                                </table>
                                <div style="display: flex; justify-content: center;">
                                    <button class="btn btn-primary" (click)="receiptSave()">Update</button>
                                </div>
                            </div>
                            </div>
                            <div style="display: flex; justify-content: center;">
                                <button class="btn btn-danger" data-dismiss="modal">Close</button>
                            </div>
                        </div>
                </div>
            </div>
        </div>

    </mat-tab>

    
    <!-------------------------------Order Allocationc[Ends]----------------------------------->


    <!-------------------------------Receipt[Start]------------------------------------------------------------------------------------------------------------------>
    <mat-tab label="Receipt">
        <div style="overflow: scroll; height: 75vh;">
            <div>
            <div [formGroup]="receiptForm">
                <table class="table">
                    <thead class="thead-dark">
                        <tr>
                            <th>Sl.No</th>
                            <th>Spin Challan</th>
                            <th>SBDL Challan</th>
                            <th>Receipt Dt</th>
                            <th>Knit Factory</th>
                            <th>Bags/Ctn - nos</th>
                            <th>Receipt Yarn Kgs</th>
                            <th>Pending Receipts - Kgs</th>
                            <th>Yarn QC</th>
                        </tr>
                    </thead>
                    <tbody >
                        <tr *ngFor="let rec of this.yarnReceiptsLines; let i = index;">
                            <td>{{i+1}}</td>
                            <td>{{rec.spinningChallan}}</td>
                            <td>{{rec.scandexChallan}}</td>
                            <td>{{rec.receiptDt}}</td>
                            <td>{{rec.knitFactory}}</td>
                            <td>{{rec.BagsCtnNos}}</td>
                            <td>{{rec.receiptYarnKgs}}</td>
                            <td>{{rec.pendingReceiptKgs}}</td>
                            <td><button class="btn btn-primary" data-toggle="modal" data-target="#yarnQcModal" (click)="receiptId(i)">Yarn QC</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            </div>
        </div>
    <div class="modal fade" id="yarnQcModal" tabindex="-1" role="dialog" aria-labelledby="yarnQcModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <div style="overflow: scroll; height: 75vh;">
                        <div >
                            <table class="table">
                                <thead class="thead-dark">
                                    <tr>
                                        <th>Spin Challan</th>
                                        <th>SBDL Challan</th>
                                        <th>Receipt Dt</th>
                                        <th>Knit Factory</th>
                                        <th>Bags/Ctn - nos</th>
                                        <th>Receipt Yarn Kgs</th>
                                        <th>Pending Receipts - Kgs</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><input type="text" class="form-control" readonly></td>
                                        <td><input type="text" class="form-control" readonly></td>
                                        <td><input type="text" class="form-control" readonly></td>
                                        <td><input type="text" class="form-control" readonly></td>
                                        <td><input type="text" class="form-control" readonly></td>
                                        <td><input type="text" class="form-control" readonly></td>
                                        <td><input type="text" class="form-control" readonly></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div>
                            <table class="table" [formGroup]="Yarn_QC">
                                <thead class="thead-dark">
                                    <tr>
                                        <th><button class="btn btn-danger" (click)="YarnQCAddButton()"
                                                style="font-size: inherit;">AddLines</button></th>
                                        <th>Check Dt</th>
                                        <th>Results</th>
                                        <th>Accept / Reject</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody formArrayName="data">
                                    <tr *ngFor="let process of items4.controls; let i=index" [formGroupName]="i">
                                        <td></td>
                                        <td>
                                            <input type="date" class="form-control" formControlName="checkDate">
                                        </td>
                                        <td>
                                            <input type="text" class="form-control" formControlName="checkResults">
                                        </td>
                                        <td>
                                            <mat-checkbox formControlName="yarnAcceptRejectStatus"></mat-checkbox>
                                        </td>
                                        <td>
                                            <button class="btn btn-danger" (click)="YarnQCDelete(i)">x</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                            <div style="display: flex; justify-content: center;">
                                <button class="btn btn-primary" (click)="yarnQcSave()">Update</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</mat-tab>
    <!-------------------------------Receipt[Ends]----------------------------------->


    <!-------------------------------Yarn QC[Start]----------------------------------->
    <mat-tab label="Yarn QC">
        <div style="overflow: scroll; height: 75vh; margin-top:3% ">
            <div>
                <table class="table">
                    <thead class="thead-dark">
                        <tr>
                            <th>Sl.No</th>
                            <th>Check Dt</th>
                            <th>Results</th>
                            <th>Accept / Reject</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let qc of this.yarnQualityCheck; let i=index">
                            <td>{{i+1}}</td>
                            <td>{{qc.checkDate}}</td>
                            <td>{{qc.checkResults}}</td>
                            <td>{{qc.yarnAcceptRejectStatus}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

    </mat-tab>
    <!-------------------------------Yarn QC[Ends]----------------------------------->
</mat-tab-group>


            </div>

            <div class="modal-footer">
                <div style="display: flex; justify-content: center;">
                    <button class="btn btn-danger" data-dismiss="modal" >Close</button>
                </div>
            </div>

        </div>
    </div>
</div>